<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GitPaste</title>
  <style>
    body {
      font-family: monospace;
      background: #0d1117;
      color: #c9d1d9;
      margin: 0;
      padding: 0;
    }
    header {
      background: #161b22;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #30363d;
    }
    header h1 {
      margin: 0;
      font-size: 20px;
      color: #58a6ff;
    }
    textarea {
      width: 100%;
      height: calc(100vh - 150px);
      background: #0d1117;
      color: #c9d1d9;
      border: none;
      resize: none;
      outline: none;
      padding: 15px;
      font-size: 15px;
    }
    .controls {
      background: #161b22;
      padding: 10px;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      border-top: 1px solid #30363d;
    }
    button {
      background: #238636;
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #2ea043;
    }
    #paste-info {
      padding: 10px 20px;
      color: #8b949e;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <header>
    <h1>GitPaste</h1>
  </header>

  <div id="paste-info"></div>

  <textarea id="paste" placeholder="Write or paste your text/code here..."></textarea>

  <div class="controls">
    <button id="save">Save</button>
    <button id="new">New</button>
    <button id="copy">Copy Link</button>
    <button id="raw">Copy Raw Link</button>
  </div>

  <script>
    const pasteBox = document.getElementById('paste');
    const info = document.getElementById('paste-info');
    const saveBtn = document.getElementById('save');
    const newBtn = document.getElementById('new');
    const copyBtn = document.getElementById('copy');
    const rawBtn = document.getElementById('raw');

    function genID() {
      return Math.random().toString(36).substring(2, 10);
    }

    const hash = location.hash.replace('#', '');
    const isRaw = hash.startsWith('raw:');
    const id = isRaw ? hash.split(':')[1] : hash;

    if (isRaw) {
      const content = localStorage.getItem('gitpaste_' + id);
      if (content) {
        document.body.innerHTML = '';
        document.write(content);
      } else {
        document.body.innerHTML = '';
        document.write('Paste not found.');
      }
    } else {
      if (id && localStorage.getItem('gitpaste_' + id)) {
        pasteBox.value = localStorage.getItem('gitpaste_' + id);
        info.textContent = `Viewing paste: ${id}`;
      } else if (id) {
        info.textContent = `Paste not found: ${id}`;
      } else {
        info.textContent = `Create a new paste below.`;
      }

      saveBtn.onclick = () => {
        let pasteID = id || genID();
        localStorage.setItem('gitpaste_' + pasteID, pasteBox.value);
        location.hash = pasteID;
        info.textContent = `Saved paste: ${pasteID}`;
      };

      newBtn.onclick = () => {
        location.hash = '';
        pasteBox.value = '';
        info.textContent = 'Create a new paste below.';
      };

      copyBtn.onclick = () => {
        const url = location.href;
        navigator.clipboard.writeText(url);
        info.textContent = 'Link copied to clipboard!';
      };

      rawBtn.onclick = () => {
        const pasteID = id || genID();
        localStorage.setItem('gitpaste_' + pasteID, pasteBox.value);
        const rawURL = location.origin + location.pathname + '#raw:' + pasteID;
        navigator.clipboard.writeText(rawURL);
        info.textContent = 'Raw link copied to clipboard!';
        location.hash = pasteID;
      };
    }
  </script>
</body>
</html>
